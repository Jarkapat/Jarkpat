<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>วิธีติดตั้ง Superset และ ClickHouse (macOS)</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      line-height: 1.6;
      max-width: 800px;
      margin: 40px auto;
      padding: 20px;
      background-color: #f5f5f5;
    }
    h1, h2 {
      color: #2c3e50;
    }
    code {
      background-color: #eee;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: monospace;
    }
    pre {
      background-color: #eee;
      padding: 10px;
      border-radius: 5px;
      overflow-x: auto;
    }
    section {
      margin-bottom: 40px;
    }
  </style>
</head>
<body>
  <h1>วิธีการติดตั้งและใช้งาน Superset & ClickHouse บน macOS</h1>

  <section>
    <h2>a. วิธีการติดตั้งและเปิดใช้งาน ClickHouse</h2>
    <p>1. ติดตั้ง ClickHouse Server และ Client ด้วย Homebrew:</p>
    <pre><code>brew install clickhouse</code></pre>

    <p>2. เริ่มต้น ClickHouse Server:</p>
    <pre><code>clickhouse-server</code></pre>

    <p>3. ในหน้าต่าง Terminal อื่น ลองเชื่อมต่อด้วย client:</p>
    <pre><code>clickhouse-client</code></pre>
  </section>

  <section>
    <h2>b. วิธีนำเข้าข้อมูลจากการบ้านที่ 4 (HW04)</h2>
    <p>1. เตรียมไฟล์ CSV หรือไฟล์ข้อมูลจากการบ้านที่ 4</p>
    <p>2. สร้างตารางใน ClickHouse:</p>
    <pre><code>CREATE TABLE nypd_complaint_raw_all_string 
      ( CMPLNT_NUM String, 
      ADDR_PCT_CD String, 
      BORO_NM String, 
      CMPLNT_FR_DT String, 
      CMPLNT_FR_TM String, 
      CMPLNT_TO_DT String, 
      CMPLNT_TO_TM String, 
      CRM_ATPT_CPTD_CD String, 
      HADEVELOPT String, 
      HOUSING_PSA String, 
      JURISDICTION_CODE String, 
      JURIS_DESC String, 
      KY_CD String, 
      LAW_CAT_CD String, 
      LOC_OF_OCCUR_DESC String, 
      OFNS_DESC String, 
      PARKS_NM String, 
      PATROL_BORO String, 
      PD_CD String, 
      PD_DESC String, 
      PREM_TYP_DESC String, 
      RPT_DT String, 
      STATION_NAME String, 
      SUSP_AGE_GROUP String, 
      SUSP_RACE String, 
      SUSP_SEX String, 
      TRANSIT_DISTRICT String, 
      VIC_AGE_GROUP String, 
      VIC_RACE String, 
      VIC_SEX String, 
      X_COORD_CD String, 
      Y_COORD_CD String, 
      Latitude String, 
      Longitude String, 
      Lat_Lon String, 
      New Georeferenced Column String ) 
      ENGINE = MergeTree 
      ORDER BY CMPLNT_NUM;</code></pre>

    <p>3. นำเข้าไฟล์ (ตัวอย่าง CSV):</p>
    <pre><code>clickhouse client --query="INSERT INTO nypd_complaint_raw_all_string FORMAT CSVWithNames" < ~/Downloads/NYPD_Complaint.csv</code></pre>
  </section>

  <section>
    <h2>c. วิธีติดตั้งและเปิดใช้งาน Apache Superset</h2>
    <p>1. สร้าง virtual environment:</p>
    <pre><code>python3 -m venv venv
source venv/bin/activate</code></pre>

    <p>2. อัปเกรด pip และติดตั้ง Superset:</p>
    <pre><code>pip install --upgrade pip setuptools wheel
pip install apache-superset</code></pre>

    <p>3. ตั้งค่าระบบ Superset:</p>
    <pre><code>superset db upgrade
export FLASK_APP=superset
superset fab create-admin  # สร้าง admin user
superset init</code></pre>

    <p>4. รัน Superset:</p>
    <pre><code>superset run -p 8088 --with-threads --reload --debugger</code></pre>
    <p>แล้วเปิด browser ที่ <a href="http://localhost:8088">http://localhost:8088</a></p>
  </section>

  <section>
    <h2>d. วิธีเชื่อม Superset กับ ClickHouse</h2>
    <p>1. ติดตั้งไดรเวอร์ ClickHouse:</p>
    <pre><code>pip install clickhouse-connect</code></pre>

    <p>2. ในหน้า Superset → ไปที่ <strong>Data → Databases → + Database</strong></p>

    <p>3. กรอก URI สำหรับเชื่อมต่อ ClickHouse:</p>
    <pre><code>clickhouse+http://default:@localhost:8123/default</code></pre>

    <p>4. กด Test Connection → แล้วกด Save</p>
    <p>คุณสามารถเลือกตารางและสร้าง Dashboard จากข้อมูลที่เชื่อมต่อได้เลย</p>
  </section>

  <section>
    <h2>e. วิธีนำเสนอข้อมูลจากข้อ b. บน Dashboard ของ Superset</h2>
    <p>1. เข้าไปที่ <strong>Data → Datasets → + Dataset</strong></p>
    <ul>
      <li>เลือก Database ที่เชื่อมไว้ (ClickHouse)</li>
      <li>เลือกตาราง: <code>Web_analytics</code></li>
      <p>เลือกใช้ข้อมูลที่สามารถ พลอตกราฟได้เนื่องจากข้อมูลเดิม clickhouse  ไม่รองรับ</p>
      <li>ตั้งชื่อ Dataset แล้วกด Save</li>
    </ul>

    <p>2. สร้าง Visualization:</p>
    <ul>
      <li>ไปที่ <strong>Charts → + Chart</strong></li>
      <li>เลือก Dataset: <code>Web_analytics</code></li>
      <li>เลือก Visualization เช่น “Pie Chart”</li>
      <li>ตั้งค่า: Dimension → <code>browser</code>, Metric → <code>COUNT(*)</code></li>
      <li>กด Run → แล้ว Save</li>
    </ul>

    <p>3. สร้าง Dashboard:</p>
    <ul>
      <li>ไปที่ <strong>Dashboards → + Dashboard</strong></li>
      <li>ตั้งชื่อ เช่น “HW04 Dashboard” แล้วกด Create</li>
      <li>เพิ่ม Chart ที่สร้างไว้ลงใน Dashboard</li>
    </ul>

    <p><strong>ผลลัพธ์:</strong> จะได้ Dashboard แสดงกราฟแท่งรวมคะแนนของแต่ละคนจาก HW04</p>
  </section>

  <section>
    <h2>f. บทสรุปการใช้งาน</h2>
    <p>Superset เป็นเครื่องมือ BI ที่ทรงพลังและใช้งานฟรี สามารถแสดงผลข้อมูลจากหลายแหล่ง เช่น ClickHouse ได้อย่างสวยงามบน Dashboard</p>
    <ul>
      <li>ClickHouse ใช้งานง่ายและเร็วมากสำหรับการประมวลผลข้อมูลขนาดใหญ่</li>
      <li>การบ้าน HW04 ที่เป็นข้อมูลเรียบง่ายสามารถแสดงผลเป็น Visualization ได้ภายในไม่กี่ขั้นตอน</li>
      <li>Dashboard ที่ได้สามารถใช้วิเคราะห์และนำเสนอผลการเรียนรู้ได้อย่างชัดเจน</li>
    </ul>
    <p>เหมาะสำหรับนักศึกษา นักวิเคราะห์ และนักพัฒนาในการฝึกใช้เครื่องมือ Data Visualization จริง</p>
  </section>

  <p><em>หมายเหตุ: หากคุณใช้ ClickHouse ผ่าน Docker ก็สามารถปรับพอร์ต/URL ได้ตามที่คุณตั้งไว้</em></p>
  <img>
</body>
</html>

